apiVersion: apps/v1
kind: Deployment
metadata:
  name: unifi-controller

spec:
  replicas: 1
  selector:
    matchLabels:
      name: unifi-controller

    template:
      metadata:
        name: unifi-controller
        labels:
          name: unifi-controller
      spec:
        volumes:
        - name: unifi-storage
          persistentVolumeClaim:
            claimName: unifi

        containers:
          - name: unifi-controller
            image: jacoalberty/unifi:v9.0
            ports:
              - containerPort: 3478
                protocol: UDP 
              - containerPort: 8080
                protocol: TCP
              - containerPort: 8443
                protocol: TCP
              - containerPort: 8843
                protocol: TCP
              - containerPort: 8880
                protocol: TCP
              - containerPort: 6789
                protocol: TCP
            volumeMounts:
              - name: unifi-storage
                mountPath: /unifi
                subPath: unifi